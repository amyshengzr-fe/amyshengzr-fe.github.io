import{_ as i,c as a,o as t,ah as e}from"./chunks/framework.B7r58Iye.js";const F=JSON.parse('{"title":"Git 仓库拆分","description":"","frontmatter":{},"headers":[],"relativePath":"share/git/split.md","filePath":"share/git/split.md"}'),h={name:"share/git/split.md"};function l(n,s,p,k,r,d){return t(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="git-仓库拆分" tabindex="-1">Git 仓库拆分 <a class="header-anchor" href="#git-仓库拆分" aria-label="Permalink to “Git 仓库拆分”">​</a></h1><p>下面是一个 <strong>最干净、最安全、可保留完整 commit 历史</strong> 的做法，通过 <strong>git subtree</strong>（简单且不会破坏原仓库） 把原仓库拆成两个独立仓库并保留各自历史记录。</p><h2 id="使用-git-subtree-split" tabindex="-1">使用 <strong>git subtree split</strong> <a class="header-anchor" href="#使用-git-subtree-split" aria-label="Permalink to “使用 git subtree split”">​</a></h2><p>假设你现在有目录：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>demo/</span></span>
<span class="line"><span>  └─ web/</span></span>
<span class="line"><span>      ├─ react/</span></span>
<span class="line"><span>      └─ vue/</span></span></code></pre></div><p>你想拆成两个新仓库：</p><ul><li>demo-react</li><li>demo-vue</li></ul><p>并保留 react、vue 各自的历史。</p><h2 id="第一步-拆出-react-历史" tabindex="-1">第一步：拆出 react 历史 <a class="header-anchor" href="#第一步-拆出-react-历史" aria-label="Permalink to “第一步：拆出 react 历史”">​</a></h2><p>在 <strong>demo 根目录</strong>执行：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> subtree</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> split</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --prefix=web/react</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -b</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react-split</span></span></code></pre></div><p>这会创建一个包含 <strong>只有 web/react 相关提交的分支</strong>：<code>react-split</code></p><p>创建新目录：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ../demo-react</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ../demo-react</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checkout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react-split</span></span></code></pre></div><p>现在 <code>demo-react</code> 就是一个 <strong>独立的 react + 完整历史</strong>仓库。</p><p>然后你可以添加新的远端仓库：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remote</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remove</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> origin</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 移除克隆来的 origin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remote</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> origin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">你的新仓库UR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> origin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> react-split:main</span></span></code></pre></div><h2 id="第二步-拆出-vue-历史" tabindex="-1">第二步：拆出 vue 历史 <a class="header-anchor" href="#第二步-拆出-vue-历史" aria-label="Permalink to “第二步：拆出 vue 历史”">​</a></h2><p>回到 demo 主仓库：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ../demo</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> subtree</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> split</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --prefix=web/vue</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -b</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vue-split</span></span></code></pre></div><p>创建新目录：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ../demo-vue</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">cd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ../demo-vue</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> checkout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vue-split</span></span></code></pre></div><p>设置远端并 push：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remote</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remove</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> origin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remote</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> origin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">你的新</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Vue</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 仓库</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> UR</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">L</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> push</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> origin</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> vue-split:main</span></span></code></pre></div><h2 id="你最终得到两个仓库" tabindex="-1">你最终得到两个仓库 <a class="header-anchor" href="#你最终得到两个仓库" aria-label="Permalink to “你最终得到两个仓库”">​</a></h2><h3 id="✔-demo-react" tabindex="-1">✔ demo-react <a class="header-anchor" href="#✔-demo-react" aria-label="Permalink to “✔ demo-react”">​</a></h3><p>包含原来 web/react 的全部代码 包含 web/react 的全部 git commit 历史（精准、干净）</p><h3 id="✔-demo-vue" tabindex="-1">✔ demo-vue <a class="header-anchor" href="#✔-demo-vue" aria-label="Permalink to “✔ demo-vue”">​</a></h3><p>包含原来 web/vue 的全部代码 包含 web/vue 的全部 git commit 历史（精准、干净）</p>`,29)])])}const o=i(h,[["render",l]]);export{F as __pageData,o as default};
